---
title: "R Notebook"
output: html_notebook
---

#Reading in Data
```{R}
dat <- read.csv("data.csv")
```

#Selecting Columns of Interest, Removing -999999
```{R}
library(tidyverse)
dat2 <- dat%>% select(c(2, 10, 69, 79, 80, 81, 91)) %>% 
  mutate(previous_day_admission_adult_covid_confirmed_7_day_sum = replace(previous_day_admission_adult_covid_confirmed_7_day_sum, previous_day_admission_adult_covid_confirmed_7_day_sum == -999999, NA)) %>%
   mutate(previous_day_admission_pediatric_covid_confirmed_7_day_sum = replace(previous_day_admission_pediatric_covid_confirmed_7_day_sum, previous_day_admission_pediatric_covid_confirmed_7_day_sum == -999999, NA)) %>%
   mutate(previous_day_covid_ED_visits_7_day_sum = replace(previous_day_covid_ED_visits_7_day_sum, previous_day_covid_ED_visits_7_day_sum == -999999, NA)) %>%
   mutate(previous_day_admission_adult_covid_suspected_7_day_sum = replace(previous_day_admission_adult_covid_suspected_7_day_sum, previous_day_admission_adult_covid_suspected_7_day_sum == -999999, NA)) %>%
   mutate(previous_day_admission_pediatric_covid_suspected_7_day_sum = replace(previous_day_admission_pediatric_covid_suspected_7_day_sum, previous_day_admission_pediatric_covid_suspected_7_day_sum == -999999, NA)) 
```

#Selecting Appropriate Weeks, Summary Statistics
```{R}
dat3 <- dat2 %>% filter(collection_week == c("2020-12-04") |
                        collection_week == c("2020-11-27")) #|
                        #collection_week == c("2020-11-20")) 

dat4 <- dat3%>%na.omit() %>% group_by(fips_code, collection_week) %>% summarize_if(is.numeric, sum)

```

#Computing Ratios
```{R}
dat4

dat5 <- subset(dat4,duplicated(fips_code) | duplicated(fips_code, fromLast=TRUE))
dat5

ratios <- data.frame(fips_code=character(), previous_day_admission_adult_covid_confirmed_7_day_sum
=double(), previous_day_admission_pediatric_covid_confirmed_7_day_sum=double(), previous_day_covid_ED_visits_7_day_sum=double(), previous_day_admission_adult_covid_suspected_7_day_sum=double(), previous_day_admission_pediatric_covid_suspected_7_day_sum=double())

for (row in seq(from=1, to=nrow(dat5), by=2)){
   c2 =  dat5[row + 1, "previous_day_admission_adult_covid_confirmed_7_day_sum"] / dat5[row, "previous_day_admission_adult_covid_confirmed_7_day_sum"]
   c3 = dat5[row + 1, "previous_day_admission_pediatric_covid_confirmed_7_day_sum"] / dat5[row, "previous_day_admission_pediatric_covid_confirmed_7_day_sum"]
   c4 = dat5[row + 1, "previous_day_covid_ED_visits_7_day_sum"] / dat5[row, "previous_day_covid_ED_visits_7_day_sum"]
   c5 = dat5[row + 1, "previous_day_admission_adult_covid_suspected_7_day_sum"] / dat5[row, "previous_day_admission_adult_covid_suspected_7_day_sum"]
   c6 = dat5[row + 1, "previous_day_admission_pediatric_covid_suspected_7_day_sum"] / dat5[row, "previous_day_admission_pediatric_covid_suspected_7_day_sum"]
   
   ratios[nrow(ratios)+1,] = c(dat5[row, "fips_code"], c2, c3, c4, c5, c6)
}
ratios
```
